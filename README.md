# Fitness Coach Desktop

Modern desktop app for coaches to manage **athletes, sessions, calendars, and messages** â€” built with **Electron + React (Vite)** and a fast local **SQLite** database. Optional **Google Calendar** sync keeps your invites aligned with clients' calendars.

> Product name: **Fitness Coach Desktop** Â· App ID: `com.offir.fitnesscoach`

---

## âœ¨ Features

- **Athletes CRM** â€” add, edit, archive athletes with quick search.
- **Calendar & Scheduling** â€” drag-and-drop sessions, day/week views (FullCalendar).
- **Session History** â€” filter by date range with per-session summaries.
- **Messages Log** â€” keep track of invitations or sent updates.
- **Settings** â€” theme, time format, and Google integration controls.
- **Local-first storage** â€” durable **SQLite** database (`better-sqlite3`) stored on the user's machine.
- **Google Calendar (optional)** â€” create/update/delete events in the connected calendar.
- **Offline friendly** â€” all features work without internet; Google sync resumes when online.
- **One-click installer (Windows)** â€” built with `electron-builder` (NSIS).

---

## ğŸ§± Tech Stack

- **Desktop:** Electron ^37.3.0 + electron-builder
- **UI:** React ^19.1.1 + Vite ^7.1.2
- **Calendar:** FullCalendar (`@fullcalendar/react`, `daygrid`, `timegrid`, `interaction`)
- **DB:** SQLite via `better-sqlite3`
- **Utilities:** `uuid`, `googleapis`
- **Dev tooling:** `concurrently`, `wait-on`, `cross-env`, `sharp` (icons)

Folder layout (abridged):
```
src/
  main.js                # Electron entry, IPC, routes
  preload.js             # Secure IPC bridge
  db.js                  # SQLite open + schema migrations
  invitations.js         # Google Calendar OAuth + event sync
  history.js             # History queries, migrations
  ui/                    # React app (Vite)
    src/
      App.jsx
      components/
        Athletes.jsx
        Calendar.jsx
        History.jsx
        Messages.jsx
        Settings.jsx
        Sidebar.jsx
```
Build config lives in **package.json â†’ build** (productName, NSIS, extraResources).

---

## ğŸš€ Getting Started (Development)

**Prereqs**: Node 18+ and npm.

```bash
# 1) Install deps
npm install

# 2) Run the app in dev (starts Vite + Electron)
npm run dev
#  - Opens the React dev server on http://localhost:5173
#  - Electron waits until the UI is ready (via wait-on)

# 3) Build the React UI only (optional)
npm run build:react
```

Common scripts:
```jsonc
npm run dev           # Vite UI + Electron (auto-waits)
npm run start         # Electron only (use after build:react)
npm run build         # Package Windows installer (NSIS)
npm run rebuild       # Rebuild native deps
npm run icons         # Generate app icons
```

---

## ğŸ—ï¸ Packaging (Windows)

Creates a signed NSIS installer in `dist/`.

```bash
npm run build
# -> dist/Fitness Coach Desktop Setup {version}.exe
```

Notes:
- Packaging uses **electron-builder** (`win`, NSIS, `productName: "Fitness Coach Desktop"`).
- Build includes the **Vite UI** output from `src/ui/dist` (generated by `build:react`).

---

## ğŸ—ƒï¸ Data & Storage

The local database is created automatically at runtime:

- **Path:** `{userData}` (OS-specific Electron userData directory)
- **Filename:** `fitcoach.db`

Main tables (auto-migrated):
- `trainees` â€” id, first_name, last_name, email, phone, status, created_at
- `sessions` â€” id, trainee_id, title, start_time, end_time, location, notes, google_event_id
- `sent_messages` â€” logs of invitations/updates
- `settings` â€” app settings and OAuth tokens (encrypted by Google; stored as JSON)

> **Backups:** you can copy the `fitcoach.db` file while the app is closed to back it up.

---

## ğŸ”— Google Calendar (Optional Sync)

The app can create/update/delete Google Calendar events for sessions.

### 1) Create OAuth credentials
1. Go to Google Cloud Console â†’ **APIs & Services** â†’ Credentials.
2. Create **OAuth Client ID** (type **Desktop App** _or_ **Web App**).
3. If you use **Web App**, add this redirect URI:  
   `http://127.0.0.1:5174/oauth2callback`

### 2) Provide credentials to the app

You can set credentials in either place:

- **A. Local env file** (development):
  - Create `src/env.local.json` with:
    ```json
    {
      "GOOGLE_CLIENT_ID": "your-client-id.apps.googleusercontent.com",
      "GOOGLE_CLIENT_SECRET": "your-client-secret"
    }
    ```
  - This file is read at startup by `loadLocalEnv()` in `src/main.js`.

- **B. In-app Settings** (production):
  - Open **Settings â†’ Google** and paste the **Client ID** and **Client Secret**.
  - Tokens are stored in the `settings` table and refreshed automatically.

### 3) Use
- Click **Connect Google** in Settings â†’ follow browser login â†’ consent.
- Choose calendar (default: `primary`) and enable **auto-sync** if desired.
- When you create or edit a session, the corresponding Google event is created or updated.

> **Quota/Errors:** If you see rate-limit errors, reduce the sync interval or disable auto-sync temporarily.

---

## ğŸ” Security Notes

- OAuth tokens are stored in the local `settings` table and refreshed via Googleâ€™s SDK.
- No credentials are committed to Git; keep `src/env.local.json` out of version control.
- The app uses **preload + IPC**; renderer does not have Node.js access.

Add a `.gitignore` entry if needed:
```
src/env.local.json
dist/
*.log
```

---

## ğŸ“¦ Project Metadata

- **Name:** fitness-coach-desktop
- **Version:** 1.0.0
- **Author:** Offir Tura
---

## ğŸ¤ Contributing

1. Fork the repo
2. Create a feature branch: `git checkout -b feat/something`
3. Commit changes, open a PR

---

## ğŸ“š Credits

- Icons generated via `src/make-icons.js` using `sharp` + `png-to-ico`
- Calendar UI powered by **FullCalendar**
